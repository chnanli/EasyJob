@{
    ViewBag.Title = "后台管理系统登录";
}
@Styles.Render("~/bui/css", "~/bootstrap/css")
@Scripts.Render("~/bui/js", "~/jquery/js", "~/bootstrap/js", "~/errorCode/js")

<style type="text/css">
    body {
        padding-top: 40px;
        padding-bottom: 40px;
        background-color: #f5f5f5;
    }

    .form-signin {
        max-width: 300px;
        padding: 19px 29px 29px;
        margin: 0 auto 20px;
        background-color: #fff;
        border: 1px solid #e5e5e5;
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;
        -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
        -moz-box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
        box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
    }

        .form-signin .form-signin-heading,
        .form-signin .checkbox {
            margin-bottom: 10px;
        }

        .form-signin input[type="text"],
        .form-signin input[type="password"] {
            font-size: 16px;
            height: auto;
            margin-bottom: 15px;
            padding: 7px 9px;
        }
</style>

<script>
    function Login() {
        var employee = {};
        employee.Code = $("#employee_Code").val();
        employee.Pwd = $("#employee_Pwd").val();
        var data = $.toJSON(employee);

        ShowErrorInfo("");//清空出错显示内容
        $("#employee_Login").val("登录中...");

        $.ajax({
            type: "POST",
            url: "/Employee/Login",
            contentType: "application/json",
            dataType: "json",
            data: data,
            success: function (ret) {
                if (ret == true) {
                    window.location.href = "/Admin/Index";
                } else {
                    LoginError("登录失败!");
                }
            },
            error: function (xhr) {
                var errMsg = xhr.responseJSON;
                LoginError(GetErrorMsg(errMsg.Error));
            }
        });
    }

    function ShowErrorInfo(msg) {
        $("#errorInfo").html(msg);
    }

    function LoginError(msg) {
        $("#employee_Login").val("登录");
        ShowErrorInfo(msg);
        $("#employee_Pwd").focus();
    }

    $(document).ready(function () {
        $('#employee_Code').keydown(function (e) {
            if (e.keyCode == 13) {
                $("#employee_Pwd").focus();
            }
        });

        $('#employee_Pwd').keydown(function (e) {
            if (e.keyCode == 13) {
                Login();
            }
        });

        $('#employee_Login').click(function () {
            Login();
        });
    });
</script>

<div class="container">

    <div class="form-signin">
        <h2 class="form-signin-heading">登录系统</h2>
        <input type="text" name="Code" id="employee_Code" class="input-block-level" placeholder="请输入工号" value="@ViewBag.OpenId">
        <input type="password" name="Pwd" id="employee_Pwd" class="input-block-level" placeholder="请输入密码">
        <input type="text" name="verify" class="input-medium" placeholder="验证码">

        <p><button class="btn btn-large btn-primary" id="employee_Login" type="submit">登录</button></p>
        <span> <span class="text-warning" id="errorInfo"></span></span>
    </div>

</div>